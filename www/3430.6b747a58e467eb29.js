"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3430],{3430:(U,F,c)=>{c.r(F),c.d(F,{ChargerConnectPageModule:()=>B});var b=c(177),h=c(9417),u=c(4488),C=c(2175),l=c(467),k=c(6539),P=c(8833),R=c(7518),A=c(6043),d=c(6013),y=c(5083);class E extends y.E_{constructor(){super(...arguments),this.ERROR_PICK_FILE_CANCELED="pickFiles canceled."}convertHeicToJpeg(r){var i=this;return(0,l.A)(function*(){throw i.unimplemented("Not implemented on web.")})()}pickFiles(r){var i=this;return(0,l.A)(function*(){const t=yield i.openFilePicker(r);if(!t)throw new Error(i.ERROR_PICK_FILE_CANCELED);const n={files:[]};for(const o of t){const a={blob:o,modifiedAt:o.lastModified,mimeType:i.getMimeTypeFromUrl(o),name:i.getNameFromUrl(o),path:void 0,size:i.getSizeFromUrl(o)};null!=r&&r.readData&&(a.data=yield i.getDataFromFile(o)),n.files.push(a)}return n})()}pickImages(r){var i=this;return(0,l.A)(function*(){return i.pickFiles(Object.assign({types:["image/*"]},r))})()}pickMedia(r){var i=this;return(0,l.A)(function*(){return i.pickFiles(Object.assign({types:["image/*","video/*"]},r))})()}pickVideos(r){var i=this;return(0,l.A)(function*(){return i.pickFiles(Object.assign({types:["video/*"]},r))})()}openFilePicker(r){var i=this;return(0,l.A)(function*(){var t;const n=(null===(t=null==r?void 0:r.types)||void 0===t?void 0:t.join(","))||"",o=!(null==r||!r.multiple);return new Promise(a=>{let m=!1;const g=document.createElement("input");g.type="file",g.accept=n,g.multiple=o,g.addEventListener("change",()=>{m=!0;const p=Array.from(g.files||[]);a(p)},{once:!0}),window.addEventListener("focus",(0,l.A)(function*(){yield i.wait(1e3),!m&&a(void 0)}),{once:!0}),g.click()})})()}getDataFromFile(r){return(0,l.A)(function*(){return new Promise((i,t)=>{const n=new FileReader;n.readAsDataURL(r),n.onload=()=>{const m=("string"==typeof n.result?n.result:"").split("base64,")[1]||"";i(m)},n.onerror=o=>{t(o)}})})()}getNameFromUrl(r){return r.name}getMimeTypeFromUrl(r){return r.type}getSizeFromUrl(r){return r.size}wait(r){return(0,l.A)(function*(){return new Promise(i=>setTimeout(i,r))})()}}const G=(0,y.F3)("FilePicker",{web:()=>new E});var S=c(6082),e=c(4438),M=c(4517),I=c(345),$=c(4842);const Q=["QrCodeRef"];function T(s,r){if(1&s&&(e.j41(0,"ion-card",15)(1,"ion-card-content")(2,"ion-item")(3,"ion-label",16),e.EFF(4,"Bytes"),e.k0s(),e.nrm(5,"ion-input",17),e.k0s(),e.j41(6,"ion-item")(7,"ion-label",16),e.EFF(8,"Corner Points"),e.k0s(),e.nrm(9,"ion-input",17),e.k0s(),e.j41(10,"ion-item")(11,"ion-label",16),e.EFF(12,"Display Value"),e.k0s(),e.nrm(13,"ion-input",17),e.k0s(),e.j41(14,"ion-item")(15,"ion-label",16),e.EFF(16,"Format"),e.k0s(),e.nrm(17,"ion-input",17),e.k0s(),e.j41(18,"ion-item")(19,"ion-label",16),e.EFF(20,"Raw Value"),e.k0s(),e.nrm(21,"ion-input",17),e.k0s(),e.j41(22,"ion-item")(23,"ion-label",16),e.EFF(24,"Value Type"),e.k0s(),e.nrm(25,"ion-input",17),e.k0s()()(),e.nrm(26,"hr")),2&s){const i=r.$implicit;e.R7$(5),e.Y8G("value",(null==i.bytes?null:i.bytes.toString())||""),e.R7$(4),e.Y8G("value",(null==i.cornerPoints?null:i.cornerPoints.toString())||""),e.R7$(4),e.Y8G("value",i.displayValue),e.R7$(4),e.Y8G("value",i.format),e.R7$(4),e.Y8G("value",i.rawValue),e.R7$(4),e.Y8G("value",i.valueType)}}const j=[{path:"",component:(()=>{var s;class r{constructor(t,n,o,a,m,g,p){var f,v=this;this.platform=t,this.loadingController=a,this.toastController=m,this.modalController=g,this.ngZone=p,this.APP_ROUTE=P._,this.barcodeFormat=d.Gi,this.lensFacing=d.Nn,this.formGroup=new h.J3({formats:new h.hs([]),lensFacing:new h.hs(d.Nn.Back),googleBarcodeScannerModuleInstallState:new h.hs(0),googleBarcodeScannerModuleInstallProgress:new h.hs(0)}),this.barcodes=[],this.isSupported=!1,this.isPermissionGranted=!1,(0,l.A)(function*(){v.loading=yield v.loadingController.create({message:""})})(),n.setTitle("K\u1ebft n\u1ed1i tr\u1ee5 s\u1ea1c"),this.QrCode=null!==(f=o.snapshot.params.code)&&void 0!==f?f:void 0}ngOnInit(){var t=this;(0,l.A)(function*(){(yield(0,k.kU)())&&t.refreshData()})()}refreshData(){var t=this;return(0,l.A)(function*(){t.QrCode?(0,A.j)({loading:n=>{var o,a;n?null===(o=t.loading)||void 0===o||o.present():null===(a=t.loading)||void 0===a||a.dismiss()},params:{QrCode:t.QrCode},callback:n=>{var o,a;t.response=n,null!=n&&n.Succeeded?(t.chargingConnector=n.Data,window.location.href=P._.CHARGING_CONNECTOR_DETAIL.replace(":id",null!==(o=null===(a=t.chargingConnector)||void 0===a||null===(a=a.ChargeConnectorId)||void 0===a?void 0:a.toString())&&void 0!==o?o:"")):(0,R.cX)(t.toastController,{},n).then(m=>m.present())}}):t.checkScan()})()}checkScan(){var t=this;return(0,l.A)(function*(){d.vi.isSupported().then(n=>{t.isSupported=n.supported}),d.vi.checkPermissions().then(n=>{t.isPermissionGranted="granted"===n.camera}),d.vi.removeAllListeners().then(()=>{d.vi.addListener("googleBarcodeScannerModuleInstallProgress",n=>{t.ngZone.run(()=>{console.log("googleBarcodeScannerModuleInstallProgress",n);const{state:o,progress:a}=n;t.formGroup.patchValue({googleBarcodeScannerModuleInstallState:o,googleBarcodeScannerModuleInstallProgress:a})})})})})()}startScan(){var t=this;return(0,l.A)(function*(){var n,o;const a=(null===(n=t.formGroup.get("formats"))||void 0===n?void 0:n.value)||[],m=(null===(o=t.formGroup.get("lensFacing"))||void 0===o?void 0:o.value)||d.Nn.Back,g=yield t.modalController.create({component:S.I,componentProps:{formats:a,lensFacing:m},cssClass:"barcode-scanning-modal",showBackdrop:!1});g.onDidDismiss().then(p=>{var v;const f=null===(v=p.data)||void 0===v?void 0:v.barcode;f&&(t.barcodes=[f])}),g.present()})()}readBarcodeFromImage(){var t=this;return(0,l.A)(function*(){var n,o;const{files:a}=yield G.pickImages({limit:1}),m=null===(n=a[0])||void 0===n?void 0:n.path;if(!m)return;const g=(null===(o=t.formGroup.get("formats"))||void 0===o?void 0:o.value)||[],{barcodes:p}=yield d.vi.readBarcodesFromImage({path:m,formats:g});t.barcodes=p})()}scan(){var t=this;return(0,l.A)(function*(){var n;const o=(null===(n=t.formGroup.get("formats"))||void 0===n?void 0:n.value)||[],{barcodes:a}=yield d.vi.scan({formats:o});t.barcodes=a})()}openSettings(){return(0,l.A)(function*(){yield d.vi.openSettings()})()}installGoogleBarcodeScannerModule(){return(0,l.A)(function*(){yield d.vi.installGoogleBarcodeScannerModule()})()}requestPermissions(){return(0,l.A)(function*(){yield d.vi.requestPermissions()})()}changeQrCode(t){var n=this;return(0,l.A)(function*(){n.QrCode=t.detail.value})()}keyupQrCode(t){var n=this;return(0,l.A)(function*(){var o,a;13!=t.keyCode?null===(o=n.QrCodeRef)||void 0===o||o.setValue(null===(a=t.target)||void 0===a?void 0:a.value):n.submitQrCode()})()}submitQrCode(t){var n=this;return(0,l.A)(function*(){n.QrCode&&n.refreshData()})()}}return(s=r).\u0275fac=function(t){return new(t||s)(e.rXU(M.OD),e.rXU(I.hE),e.rXU(C.nX),e.rXU(u.Xi),e.rXU(u.K_),e.rXU(u.W3),e.rXU(e.SKi))},s.\u0275cmp=e.VBU({type:s,selectors:[["app-charger-connect"]],viewQuery:function(t,n){if(1&t&&e.GBs(Q,5),2&t){let o;e.mGM(o=e.lsd())&&(n.QrCodeRef=o.first)}},decls:30,vars:9,consts:[["slot","start"],["icon","../../../assets/icon/ion-icon/arrow-left.svg","text","",3,"defaultHref"],[1,"h-100","d-flex","flex-column","container","container-connect","py-3"],[1,"flex-grow-1"],["expand","block","shape","round",3,"disabled","click"],["slot","start","src","../../../assets/icon/ion-icon/scan-qr.svg"],[1,"mt-3"],[1,"row","mt-3"],[1,"col"],["mode","ios","lines","none"],["type","number","placeholder","Nh\u1eadp m\xe3 \u0111\u1ea7u s\u1ea1c",3,"ionChange","keyup"],["QrCodeInpRef",""],[1,"col-auto","pl-0"],["mode","ios",3,"click"],["name","chevron-forward-outline"],[1,"ion-no-margin"],["position","fixed"],["type","text","readonly","",3,"value"]],template:function(t,n){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e.nrm(3,"ion-back-button",1),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"K\u1ebft n\u1ed1i tr\u1ee5 s\u1ea1c"),e.k0s()()(),e.j41(6,"ion-content")(7,"div",2)(8,"div",3),e.Z7z(9,T,27,6,null,null,e.fX1),e.k0s(),e.j41(11,"div")(12,"ion-button",4),e.bIt("click",function(){return n.startScan()}),e.nrm(13,"ion-icon",5),e.j41(14,"ion-label"),e.EFF(15),e.nI1(16,"translate"),e.k0s()()(),e.j41(17,"div",6)(18,"ion-button",4),e.bIt("click",function(){return n.scan()}),e.j41(19,"ion-label"),e.EFF(20),e.nI1(21,"translate"),e.k0s()()(),e.j41(22,"div",7)(23,"div",8)(24,"ion-item",9)(25,"ion-input",10,11),e.bIt("ionChange",function(a){return n.changeQrCode(a)})("keyup",function(a){return n.keyupQrCode(a)}),e.k0s()()(),e.j41(27,"div",12)(28,"ion-button",13),e.bIt("click",function(a){return n.submitQrCode(a)}),e.nrm(29,"ion-icon",14),e.k0s()()()()()),2&t&&(e.R7$(3),e.Y8G("defaultHref",n.APP_ROUTE.TABS_CHARGING_SESSION),e.R7$(6),e.Dyx(n.barcodes),e.R7$(3),e.Y8G("disabled",!n.isSupported),e.R7$(3),e.JRh(e.bMT(16,5,"ScanQR")),e.R7$(3),e.Y8G("disabled",!n.isSupported),e.R7$(2),e.SpI("",e.bMT(21,7,"ScanQR")," - Google Len"))},dependencies:[u.Jm,u.QW,u.b_,u.I9,u.W9,u.eU,u.iq,u.$w,u.uz,u.he,u.BC,u.ai,u.su,u.Gw,u.el,$.D9],styles:[".container-connect[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--min-height: 3rem;--border-radius: 1.5rem}.container-connect[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0;min-height:3rem;min-width:3rem;--border-radius: 1.5rem;--padding-top: 0;--padding-start: 0;--padding-end: 0;--padding-bottom: 0}.container-connect[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.5rem}h4[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:.25rem;vertical-align:middle;font-size:1.4rem}"]}),r})()}];let O=(()=>{var s;class r{}return(s=r).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[C.iI.forChild(j),C.iI]}),r})();var D=c(9500),w=c(5788);let B=(()=>{var s;class r{}return(s=r).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[b.MD,h.YN,u.bv,O,D.x,w.Ph]}),r})()}}]);