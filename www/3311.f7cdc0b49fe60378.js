"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3311],{9976:(W,_,a)=>{a.d(_,{Z:()=>u});var L=a(467),T=a(5312),M=a(3801),D=a(6841),p=a(1312),R=a(7518),A=a(8833),t=a(4438),g=a(4488),P=a(177),y=a(4842);const O=h=>({$implicit:h});function G(h,I){if(1&h&&(t.qex(0),t.eu8(1,2),t.bVm()),2&h){const v=t.XpG(),e=t.sdS(2);t.R7$(1),t.Y8G("ngTemplateOutlet",e)("ngTemplateOutletContext",t.eq3(2,O,v.chargingLocation))}}function x(h,I){if(1&h){const v=t.RV6();t.j41(0,"div",3)(1,"div",4),t.bIt("click",function(){const c=t.eBV(v).$implicit,i=t.XpG();return t.Njj(i.openDetail(c.ChargeLocationId))}),t.j41(2,"div",5)(3,"ion-avatar"),t.nrm(4,"img",6),t.k0s(),t.j41(5,"div",7)(6,"small"),t.EFF(7),t.k0s()()(),t.j41(8,"div",8)(9,"h5",9)(10,"b"),t.EFF(11),t.k0s()(),t.j41(12,"div")(13,"small"),t.EFF(14),t.k0s()()()(),t.j41(15,"div",10)(16,"div",11)(17,"div"),t.nrm(18,"ion-icon",12),t.k0s(),t.j41(19,"small")(20,"b"),t.EFF(21),t.k0s(),t.j41(22,"b"),t.EFF(23),t.k0s()(),t.j41(24,"small",13),t.EFF(25,"\u0111\u1ea7u s\u1ea1c s\u1eb5n s\xe0ng"),t.k0s()(),t.j41(26,"ion-button",14),t.bIt("click",function(s){const i=t.eBV(v).$implicit,m=t.XpG();return t.Njj(m.openDirection(s,i))}),t.j41(27,"ion-label"),t.EFF(28),t.nI1(29,"translate"),t.k0s(),t.nrm(30,"ion-icon",15),t.k0s()()()}if(2&h){const v=I.$implicit,e=t.XpG();let s,c;t.R7$(7),t.SpI("",e.getDistance2CL(v),"km"),t.R7$(4),t.JRh(v.LocName),t.R7$(3),t.JRh(v.LocAddress),t.R7$(6),t.HbH(v.TotalConnectorReady?"text-primary":"text-danger"),t.R7$(1),t.JRh(null!==(s=v.TotalConnectorReady)&&void 0!==s?s:0),t.R7$(2),t.SpI("/",null!==(c=v.TotalConnector)&&void 0!==c?c:0,""),t.R7$(3),t.Y8G("color",e.APP_FUNC_GetColor_VLocationStatus(v.VLocationStatus)),t.R7$(2),t.JRh(t.bMT(29,9,"Direction"))}}let u=(()=>{var h;class I{constructor(e,s){this.modalController=e,this.toastController=s,this.APP_ROUTE=A._,this.APP_FUNC_GetColor_VLocationStatus=p.Bb,this.currentPosition=T.c.app_default.geolocation.pos,(0,M.X)().then(c=>this.currentPosition=c)}ngOnInit(){this.loadData()}loadData(){var e=this;return(0,L.A)(function*(){(0,D.x1)({params:{ChargeLocationId:e.ChargeLocationId},callback:s=>{var c,i,m,f,o;null!=s&&s.Succeeded?(e.chargingLocation=null!==(c=s.Data)&&void 0!==c?c:{},null!==(i=e.chargingLocation)&&void 0!==i&&i.LocImages&&"string"==typeof(null===(m=e.chargingLocation)||void 0===m?void 0:m.LocImages)&&(e.chargingLocation.LocImage=(null!==(f=JSON.parse(null===(o=e.chargingLocation)||void 0===o?void 0:o.LocImages))&&void 0!==f?f:[])[0].imageurl)):(0,R.cX)(e.toastController,{},s).then(n=>n.present())}})})()}openDetail(e){return(0,L.A)(function*(){window.location.href=A._.CHARGING_LOCATION_DETAIL.replace(":id",e)})()}Direction(){var e=this;return(0,L.A)(function*(){e.modalController.dismiss(e.chargingLocation,"Direction")})()}OpenGoogleMap(){var e=this;return(0,L.A)(function*(){e.modalController.dismiss(e.chargingLocation,"GoogleMap")})()}openDirection(e,s){var c=this;return(0,L.A)(function*(){c.modalController.dismiss(s,"GoogleMap")})()}getDistance2CL(e){return parseFloat((0,p.GH)(this.currentPosition,{lat:null==e?void 0:e.LocLat,lng:null==e?void 0:e.LocLong}).toFixed(2))}getLocImage(e){var s;if(!e.LocImage&&e.LocImages)if("string"==typeof e.LocImages){var c,i;e.LocImage=(null!==(c=(null!==(i=JSON.parse(e.LocImages))&&void 0!==i?i:[])[0])&&void 0!==c?c:{}).imageurl}else{var m,f;e.LocImage=(null!==(m=(null!==(f=e.LocImages)&&void 0!==f?f:[])[0])&&void 0!==m?m:{}).imageurl}return null!==(s=e.LocImage)&&void 0!==s?s:"assets/favicon/favicon.svg"}}return(h=I).\u0275fac=function(e){return new(e||h)(t.rXU(g.W3),t.rXU(g.K_))},h.\u0275cmp=t.VBU({type:h,selectors:[["app-modal-map-market"]],inputs:{ChargeLocationId:"ChargeLocationId"},decls:3,vars:1,consts:[[4,"ngIf"],["templateChargingLocation",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"card-day","bg-white","p-3"],[1,"d-flex","align-items-start","cursor-pointer",3,"click"],[1,"col-auto","px-0"],["src","../../../../assets/favicon/favicon.png"],[1,"text-danger","text-center"],[1,"col","pl-2","pr-0"],[1,"mt-0","mb-1"],[1,"d-flex","justify-content-between","mt-2"],[1,"d-flex","align-items-center"],["color","primary","src","../../../assets/icon/ion-icon/electric.svg",1,"fs-4"],[1,"ml-2"],["size","small","shape","round",3,"color","click"],["src","../../../assets/icon/ion-icon/direction.svg","slot","end"]],template:function(e,s){1&e&&t.DNE(0,G,2,4,"ng-container",0)(1,x,31,11,"ng-template",null,1,t.C5r),2&e&&t.Y8G("ngIf",s.chargingLocation)},dependencies:[P.bT,P.T3,g.mC,g.Jm,g.iq,g.he,y.D9],styles:[".card-day[_ngcontent-%COMP%]{border-radius:1rem}.card-day[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{width:2rem;height:2rem}"]}),I})()},3311:(W,_,a)=>{a.r(_),a.d(_,{MapVietbandoPageModule:()=>c});var L=a(177),T=a(9417),M=a(4488),D=a(2175),p=a(467),R=a(9976),A=a(7392),t=a(7762),g=a(5312),P=a(3801),y=a(6841),O=a(1312),G=a(7518),x=a(8833),u=a(4438),h=a(345);const v=[{path:"",component:(()=>{var i;class m{constructor(o,n,r,l){this.modalController=n,this.animationController=r,this.toastController=l,this.APP_ROUTE=x._,this.markers=[],this.ChargingLocationParams={TopLeftLat:10.914656,TopLeftLong:106.44876,RightBottomLat:10.305755,RightBottomLong:107.1056,PageNumber:1,PageSize:100},this.ChargingLocations=[],this.timeoutLoadData=-1,this.isWaitLoad=!1,o.setTitle("T\xecm tr\u1ea1m s\u1ea1c")}ngOnInit(){this.refreshCurrentPosition()}ngAfterViewInit(){if(this.vbd)this.createMap();else{let o=document.createElement("script");o.src="https://developers.vietbando.com/V2/Scripts/VietbandoMapsAPI.js?key=eded04b3-6981-489d-b617-a5e5d9f609dd",o.onload=()=>{this.createMap()},window.document.head.append(o)}}get vbd(){return window.vbd}onSearchbarChange(o){var n=this;return(0,p.A)(function*(){console.log("onSearchbarChange",o);let r=o.detail.value;r&&(0,y.tC)({params:{Search:r,PageNumber:1,PageSize:10},callback:l=>{var d;n.response=l,null!=l&&l.Succeeded&&l.Data&&(l.Data.forEach(C=>{var E,b;n.markers.push({id:C.ChargeLocationId,title:C.LocAddress,position:{lat:null!==(E=C.LocLat)&&void 0!==E?E:g.c.app_default.geolocation.pos.lat,lng:null!==(b=C.LocLong)&&void 0!==b?b:g.c.app_default.geolocation.pos.lng}})}),n.createMarker(),n.ChargingLocations=null!==(d=l.Data)&&void 0!==d?d:[])}})})()}onSearchbarCancel(o){return(0,p.A)(function*(){console.log("onSearchbarCancel",o)})()}onSearchbarClear(o){var n=this;return(0,p.A)(function*(){console.log("onSearchbarClear",o),n.ChargingLocations.length=0})()}loadData(){var o=this;return(0,p.A)(function*(){(0,y.Bc)({params:o.ChargingLocationParams,callback:n=>{o.response=n,null!=n&&n.Succeeded&&n.Data&&(n.Data.forEach(r=>{var l,d;o.markers.push({id:r.ChargeLocationId,title:r.LocAddress,position:{lat:null!==(l=r.LocLat)&&void 0!==l?l:g.c.app_default.geolocation.pos.lat,lng:null!==(d=r.LocLong)&&void 0!==d?d:g.c.app_default.geolocation.pos.lng}})}),o.createMarker())}})})()}waitLoad(){var o=this;return(0,p.A)(function*(){if(o.timeoutLoadData=1e3,o.isWaitLoad)return;o.isWaitLoad=!0;let n=setInterval(()=>{o.timeoutLoadData>=0?o.timeoutLoadData-=100:(clearTimeout(n),o.isWaitLoad=!1,o.loadData())},100)})()}refreshCurrentPosition(o){var n=this;return(0,p.A)(function*(){let r=yield(0,P.X)();t.L.getCurrentPosition({enableHighAccuracy:!0,maximumAge:3e5}).then(function(){var l=(0,p.A)(function*(d){d.coords&&(r={lat:d.coords.latitude,lng:d.coords.longitude},yield(0,P.f)({params:r}),n.createCurrentPosition(r),n.resetCamera(r))});return function(d){return l.apply(this,arguments)}}()),n.createCurrentPosition(r),n.resetCamera(r)})()}currentGeolocation(o){var n=this;return(0,p.A)(function*(){return r=null!=o?o:yield(0,P.X)(),new n.vbd.LatLng(r.lat,r.lng);var r})()}createMap(){var o=this;return(0,p.A)(function*(){o.map=new o.vbd.Map(document.getElementById("map"),{center:yield o.currentGeolocation(),zoom:g.c.app_default.geolocation.zoom,maxZoom:18,minZoom:6,layer:null,zoomControl:!1,scaleControl:!1}),window.map=o.map,o.vbd.event.addListener(o.map,"boundchange",()=>{let n=o.map.getBounds();if(n&&"object"==typeof n){let r=[],l=[];r.push(n.sw.Latitude),r.push(n.sw.Longitude),l.push(n.ne.Latitude),l.push(n.ne.Longitude),o.ChargingLocationParams.TopLeftLat=Math.min.apply(null,l),o.ChargingLocationParams.TopLeftLong=Math.max.apply(null,r),o.ChargingLocationParams.RightBottomLat=Math.min.apply(null,r),o.ChargingLocationParams.RightBottomLong=Math.max.apply(null,l)}o.waitLoad()}),o.refreshCurrentPosition()})()}resetCamera(o){var n=this;return(0,p.A)(function*(){n.map&&(n.map.setCenter(yield n.currentGeolocation()),n.map.setZoom(g.c.app_default.geolocation.zoom))})()}createCurrentPosition(o){var n=this;return(0,p.A)(function*(){n.markerGeoLocaltion&&n.markerGeoLocaltion.setMap(null),n.markerGeoLocaltion=new n.vbd.Marker({map:n.map,position:yield n.currentGeolocation(o),icon:{url:g.c.app_default.icon.currentlocaltion,size:new n.vbd.Size(40,40)}})})()}createMarker(){var o=this;return(0,p.A)(function*(){o.markers.forEach(n=>{let r=new o.vbd.Marker({map:o.map,position:(l=n.position,new o.vbd.LatLng(l.lat,l.lng)),title:n.title,icon:{url:g.c.app_default.icon.marker,size:new o.vbd.Size(30,40)}});var l;o.vbd.event.addListener(r,"click",()=>{o.presentModalMarket(void 0,n.id)})})})()}openDirectionByGoogleMap(o){return(0,p.A)(function*(){yield A.P.open({url:(0,O.LZ)(yield(0,P.X)(),o.position)})})()}presentModalMarket(o,n){var r=this;return(0,p.A)(function*(){const l=yield r.modalController.create({component:R.Z,componentProps:{ChargeLocationId:n},mode:"ios",cssClass:"ion-modal-map-market"});l.onDidDismiss().then(d=>{var C,E,b,V,k,B,F,j,U,S;"Direction"!=d.role&&"GoogleMap"==d.role&&r.openDirectionByGoogleMap({id:null!==(C=null===(E=d.data)||void 0===E?void 0:E.ChargeLocationId)&&void 0!==C?C:0,title:null!==(b=null!==(V=null===(k=d.data)||void 0===k?void 0:k.LocName)&&void 0!==V?V:null===(B=d.data)||void 0===B?void 0:B.LocAddress)&&void 0!==b?b:"",position:{lat:null!==(F=null===(j=d.data)||void 0===j?void 0:j.LocLat)&&void 0!==F?F:g.c.app_default.geolocation.pos.lat,lng:null!==(U=null===(S=d.data)||void 0===S?void 0:S.LocLong)&&void 0!==U?U:g.c.app_default.geolocation.pos.lng}})}),l.present()})()}presentModalNotify(o){var n=this;return(0,p.A)(function*(){(0,G.He)(n.modalController,n.animationController)})()}}return(i=m).\u0275fac=function(o){return new(o||i)(u.rXU(h.hE),u.rXU(M.W3),u.rXU(M.Hx),u.rXU(M.K_))},i.\u0275cmp=u.VBU({type:i,selectors:[["app-map-vietbando"]],decls:5,vars:1,consts:[["scroll-x","false","scroll-y","false",3,"fullscreen"],["id","map"],[1,"position-absolute","bottom-0","right-0"],["id","btn-geolocation","color","light",3,"click"],["src","../../../assets/icon/map/geolocation.svg"]],template:function(o,n){1&o&&(u.j41(0,"ion-content",0),u.nrm(1,"div",1),u.j41(2,"div",2)(3,"ion-button",3),u.bIt("click",function(l){return n.refreshCurrentPosition(l)}),u.nrm(4,"ion-icon",4),u.k0s()()()),2&o&&u.Y8G("fullscreen",!0)},dependencies:[M.Jm,M.W9,M.iq],styles:["#map[_ngcontent-%COMP%]{width:100%;height:100%;width:100vw;height:100vh}#btn-geolocation[_ngcontent-%COMP%]{width:3rem;height:3rem;min-width:3rem;min-height:3rem;--padding-top: 0;--padding-start: 0;--padding-end: 0;--padding-bottom: 0;--border-radius: 50%;margin:0 1rem 6rem 0}#btn-geolocation[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:3rem;color:var(--ion-color-tertiary)}"]}),m})()}];let e=(()=>{var i;class m{}return(i=m).\u0275fac=function(o){return new(o||i)},i.\u0275mod=u.$C({type:i}),i.\u0275inj=u.G2t({imports:[D.iI.forChild(v),D.iI]}),m})();var s=a(9500);let c=(()=>{var i;class m{}return(i=m).\u0275fac=function(o){return new(o||i)},i.\u0275mod=u.$C({type:i}),i.\u0275inj=u.G2t({imports:[L.MD,T.YN,M.bv,e,s.x]}),m})()}}]);