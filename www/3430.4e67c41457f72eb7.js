"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3430],{3430:(O,C,c)=>{c.r(C),c.d(C,{ChargerConnectPageModule:()=>Q});var y=c(177),f=c(9417),u=c(3092),v=c(7625),s=c(467),k=c(6539),P=c(8833),R=c(8650),A=c(6043),m=c(6013),F=c(5083);class M extends F.E_{constructor(){super(...arguments),this.ERROR_PICK_FILE_CANCELED="pickFiles canceled."}checkPermissions(){var o=this;return(0,s.A)(function*(){throw o.unimplemented("Not implemented on web.")})()}convertHeicToJpeg(o){var i=this;return(0,s.A)(function*(){throw i.unimplemented("Not implemented on web.")})()}pickFiles(o){var i=this;return(0,s.A)(function*(){const t=yield i.openFilePicker(o);if(!t)throw new Error(i.ERROR_PICK_FILE_CANCELED);const n={files:[]};for(const r of t){const a={blob:r,modifiedAt:r.lastModified,mimeType:i.getMimeTypeFromUrl(r),name:i.getNameFromUrl(r),path:void 0,size:i.getSizeFromUrl(r)};null!=o&&o.readData&&(a.data=yield i.getDataFromFile(r)),n.files.push(a)}return n})()}pickDirectory(){var o=this;return(0,s.A)(function*(){throw o.unimplemented("Not implemented on web.")})()}pickImages(o){var i=this;return(0,s.A)(function*(){return i.pickFiles(Object.assign({types:["image/*"]},o))})()}pickMedia(o){var i=this;return(0,s.A)(function*(){return i.pickFiles(Object.assign({types:["image/*","video/*"]},o))})()}pickVideos(o){var i=this;return(0,s.A)(function*(){return i.pickFiles(Object.assign({types:["video/*"]},o))})()}requestPermissions(o){var i=this;return(0,s.A)(function*(){throw i.unimplemented("Not implemented on web.")})()}openFilePicker(o){var i=this;return(0,s.A)(function*(){var t;const n=(null===(t=null==o?void 0:o.types)||void 0===t?void 0:t.join(","))||"",r=void 0===(null==o?void 0:o.limit)?0:o.limit;return new Promise(a=>{let d=!1;const g=document.createElement("input");g.type="file",g.accept=n,g.multiple=0===r,g.addEventListener("change",()=>{d=!0;const h=Array.from(g.files||[]);a(h)},{once:!0}),window.addEventListener("focus",(0,s.A)(function*(){yield i.wait(1e3),!d&&a(void 0)}),{once:!0}),g.click()})})()}getDataFromFile(o){return(0,s.A)(function*(){return new Promise((i,t)=>{const n=new FileReader;n.readAsDataURL(o),n.onload=()=>{const d=("string"==typeof n.result?n.result:"").split("base64,")[1]||"";i(d)},n.onerror=r=>{t(r)}})})()}getNameFromUrl(o){return o.name}getMimeTypeFromUrl(o){return o.type}getSizeFromUrl(o){return o.size}wait(o){return(0,s.A)(function*(){return new Promise(i=>setTimeout(i,o))})()}}const G=(0,F.F3)("FilePicker",{web:()=>new M});var I=c(5005),e=c(4438),S=c(5032),j=c(4842);const $=["QrCodeRef"];function E(l,o){if(1&l&&(e.j41(0,"ion-card",15)(1,"ion-card-content")(2,"ion-item")(3,"ion-label",16),e.EFF(4,"Bytes"),e.k0s(),e.nrm(5,"ion-input",17),e.k0s(),e.j41(6,"ion-item")(7,"ion-label",16),e.EFF(8,"Corner Points"),e.k0s(),e.nrm(9,"ion-input",17),e.k0s(),e.j41(10,"ion-item")(11,"ion-label",16),e.EFF(12,"Display Value"),e.k0s(),e.nrm(13,"ion-input",17),e.k0s(),e.j41(14,"ion-item")(15,"ion-label",16),e.EFF(16,"Format"),e.k0s(),e.nrm(17,"ion-input",17),e.k0s(),e.j41(18,"ion-item")(19,"ion-label",16),e.EFF(20,"Raw Value"),e.k0s(),e.nrm(21,"ion-input",17),e.k0s(),e.j41(22,"ion-item")(23,"ion-label",16),e.EFF(24,"Value Type"),e.k0s(),e.nrm(25,"ion-input",17),e.k0s()()(),e.nrm(26,"hr")),2&l){const i=o.$implicit;e.R7$(5),e.Y8G("value",(null==i.bytes?null:i.bytes.toString())||""),e.R7$(4),e.Y8G("value",(null==i.cornerPoints?null:i.cornerPoints.toString())||""),e.R7$(4),e.Y8G("value",i.displayValue),e.R7$(4),e.Y8G("value",i.format),e.R7$(4),e.Y8G("value",i.rawValue),e.R7$(4),e.Y8G("value",i.valueType)}}const w=[{path:"",component:(()=>{var l;class o{constructor(t,n,r,a,d,g,h){var p;this.router=t,this.platform=n,this.loadingController=a,this.toastController=d,this.modalController=g,this.ngZone=h,this.APP_ROUTE=P._,this.barcodeFormat=m.Gi,this.lensFacing=m.Nn,this.formGroup=new f.J3({formats:new f.hs([]),lensFacing:new f.hs(m.Nn.Back),googleBarcodeScannerModuleInstallState:new f.hs(0),googleBarcodeScannerModuleInstallProgress:new f.hs(0)}),this.barcodes=[],this.isSupported=!1,this.isPermissionGranted=!1,this.QrCode=null!==(p=r.snapshot.params.code)&&void 0!==p?p:void 0}ngOnInit(){var t=this;(0,s.A)(function*(){(yield(0,k.kU)())&&t.refreshData()})()}refreshData(){var t=this;return(0,s.A)(function*(){t.QrCode?(0,A.j)({loadingController:t.loadingController,params:{QrCode:t.QrCode},callback:n=>{var r;t.response=n,null!=n&&n.Succeeded?(t.chargingConnector=n.Data,t.router.navigateByUrl(P._.CHARGING_CONNECTOR_DETAIL.replace(":qrcode",null!==(r=t.QrCode)&&void 0!==r?r:""))):(0,R.cX)(t.toastController,{},n).then(a=>a.present())}}):t.checkScan()})()}checkScan(){var t=this;return(0,s.A)(function*(){m.vi.isSupported().then(n=>{t.isSupported=n.supported}),m.vi.checkPermissions().then(n=>{t.isPermissionGranted="granted"===n.camera}),m.vi.removeAllListeners().then(()=>{m.vi.addListener("googleBarcodeScannerModuleInstallProgress",n=>{t.ngZone.run(()=>{console.log("googleBarcodeScannerModuleInstallProgress",n);const{state:r,progress:a}=n;t.formGroup.patchValue({googleBarcodeScannerModuleInstallState:r,googleBarcodeScannerModuleInstallProgress:a})})})})})()}startScan(){var t=this;return(0,s.A)(function*(){var n,r;const a=(null===(n=t.formGroup.get("formats"))||void 0===n?void 0:n.value)||[],d=(null===(r=t.formGroup.get("lensFacing"))||void 0===r?void 0:r.value)||m.Nn.Back,g=yield t.modalController.create({component:I.I,componentProps:{formats:a,lensFacing:d},cssClass:"barcode-scanning-modal",showBackdrop:!1});g.onDidDismiss().then(h=>{var p;const b=null===(p=h.data)||void 0===p?void 0:p.barcode;b&&(t.barcodes=[b])}),g.present()})()}readBarcodeFromImage(){var t=this;return(0,s.A)(function*(){var n,r;const{files:a}=yield G.pickImages({limit:1}),d=null===(n=a[0])||void 0===n?void 0:n.path;if(!d)return;const g=(null===(r=t.formGroup.get("formats"))||void 0===r?void 0:r.value)||[],{barcodes:h}=yield m.vi.readBarcodesFromImage({path:d,formats:g});t.barcodes=h})()}scan(){var t=this;return(0,s.A)(function*(){var n;const r=(null===(n=t.formGroup.get("formats"))||void 0===n?void 0:n.value)||[],{barcodes:a}=yield m.vi.scan({formats:r});t.barcodes=a})()}openSettings(){return(0,s.A)(function*(){yield m.vi.openSettings()})()}installGoogleBarcodeScannerModule(){return(0,s.A)(function*(){yield m.vi.installGoogleBarcodeScannerModule()})()}requestPermissions(){return(0,s.A)(function*(){yield m.vi.requestPermissions()})()}changeQrCode(t){var n=this;return(0,s.A)(function*(){n.QrCode=t.detail.value})()}keyupQrCode(t){var n=this;return(0,s.A)(function*(){var r,a;13!=t.keyCode?null===(r=n.QrCodeRef)||void 0===r||r.setValue(null===(a=t.target)||void 0===a?void 0:a.value):n.submitQrCode()})()}submitQrCode(t){var n=this;return(0,s.A)(function*(){n.QrCode&&n.refreshData()})()}}return(l=o).\u0275fac=function(t){return new(t||l)(e.rXU(v.Ix),e.rXU(S.OD),e.rXU(v.nX),e.rXU(u.Xi),e.rXU(u.K_),e.rXU(u.W3),e.rXU(e.SKi))},l.\u0275cmp=e.VBU({type:l,selectors:[["app-charger-connect"]],viewQuery:function(t,n){if(1&t&&e.GBs($,5),2&t){let r;e.mGM(r=e.lsd())&&(n.QrCodeRef=r.first)}},decls:32,vars:15,consts:[["QrCodeInpRef",""],["slot","start"],["icon","../../../assets/icon/ion-icon/arrow-left.svg","text","",3,"defaultHref"],[1,"h-100","d-flex","flex-column","container","container-connect","py-3"],[1,"flex-grow-1"],["expand","block","shape","round",3,"click","disabled"],["slot","start","src","../../../assets/icon/ion-icon/scan-qr.svg"],[1,"mt-3"],[1,"row","mt-3"],[1,"col"],["mode","ios","lines","none"],["type","number",3,"ionChange","keyup","placeholder"],[1,"col-auto","pl-0"],["mode","ios",3,"click"],["name","chevron-forward-outline"],[1,"ion-no-margin"],["position","fixed"],["type","text","readonly","",3,"value"]],template:function(t,n){if(1&t){const r=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-back-button",2),e.k0s(),e.j41(4,"ion-title"),e.EFF(5),e.nI1(6,"translate"),e.k0s()()(),e.j41(7,"ion-content")(8,"div",3)(9,"div",4),e.Z7z(10,E,27,6,null,null,e.fX1),e.k0s(),e.j41(12,"div")(13,"ion-button",5),e.bIt("click",function(){return e.eBV(r),e.Njj(n.startScan())}),e.nrm(14,"ion-icon",6),e.j41(15,"ion-label"),e.EFF(16),e.nI1(17,"translate"),e.k0s()()(),e.j41(18,"div",7)(19,"ion-button",5),e.bIt("click",function(){return e.eBV(r),e.Njj(n.scan())}),e.j41(20,"ion-label"),e.EFF(21),e.nI1(22,"translate"),e.k0s()()(),e.j41(23,"div",8)(24,"div",9)(25,"ion-item",10)(26,"ion-input",11,0),e.nI1(28,"translate"),e.bIt("ionChange",function(d){return e.eBV(r),e.Njj(n.changeQrCode(d))})("keyup",function(d){return e.eBV(r),e.Njj(n.keyupQrCode(d))}),e.k0s()()(),e.j41(29,"div",12)(30,"ion-button",13),e.bIt("click",function(d){return e.eBV(r),e.Njj(n.submitQrCode(d))}),e.nrm(31,"ion-icon",14),e.k0s()()()()()}2&t&&(e.R7$(3),e.Y8G("defaultHref",n.APP_ROUTE.CHARGING_SESSION),e.R7$(2),e.JRh(e.bMT(6,7,"ChargerConnect")),e.R7$(5),e.Dyx(n.barcodes),e.R7$(3),e.Y8G("disabled",!n.isSupported),e.R7$(3),e.JRh(e.bMT(17,9,"ScanQR")),e.R7$(3),e.Y8G("disabled",!n.isSupported),e.R7$(2),e.SpI("",e.bMT(22,11,"ScanQR")," - Google Len"),e.R7$(5),e.FS9("placeholder",e.bMT(28,13,"EnterConnectorCode")))},dependencies:[u.Jm,u.QW,u.b_,u.I9,u.W9,u.eU,u.iq,u.$w,u.uz,u.he,u.BC,u.ai,u.su,u.Gw,u.el,j.D9],styles:[".container-connect[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--min-height: 3rem;--border-radius: 1.5rem}.container-connect[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0;min-height:3rem;min-width:3rem;--border-radius: 1.5rem;--padding-top: 0;--padding-start: 0;--padding-end: 0;--padding-bottom: 0}.container-connect[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.5rem}h4[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:.25rem;vertical-align:middle;font-size:1.4rem}"]}),o})()}];let B=(()=>{var l;class o{}return(l=o).\u0275fac=function(t){return new(t||l)},l.\u0275mod=e.$C({type:l}),l.\u0275inj=e.G2t({imports:[v.iI.forChild(w),v.iI]}),o})();var T=c(3890),N=c(5788);let Q=(()=>{var l;class o{}return(l=o).\u0275fac=function(t){return new(t||l)},l.\u0275mod=e.$C({type:l}),l.\u0275inj=e.G2t({imports:[y.MD,f.YN,u.bv,B,T.x,N.Ph]}),o})()}}]);