"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3311],{9976:(W,b,i)=>{i.d(b,{Z:()=>x});var L=i(467),O=i(5312),f=i(3801),I=i(6841),u=i(1312),A=i(7518),y=i(8833),t=i(4438),d=i(4488),P=i(177),D=i(4842);const R=g=>({$implicit:g});function T(g,M){if(1&g&&(t.qex(0),t.eu8(1,2),t.bVm()),2&g){const s=t.XpG(),e=t.sdS(5);t.R7$(1),t.Y8G("ngTemplateOutlet",e)("ngTemplateOutletContext",t.eq3(2,R,s.chargingLocation))}}function k(g,M){if(1&g){const s=t.RV6();t.qex(0),t.j41(1,"div",3),t.nrm(2,"hr",4),t.k0s(),t.j41(3,"div",5)(4,"div")(5,"ion-text",6)(6,"small"),t.EFF(7),t.k0s(),t.EFF(8," - "),t.j41(9,"small"),t.EFF(10),t.k0s()()(),t.j41(11,"div")(12,"ion-button",7),t.bIt("click",function(c){t.eBV(s);const a=t.XpG();return t.Njj(a.openDirection(c,a.chargingLocation))}),t.j41(13,"ion-label"),t.EFF(14),t.nI1(15,"translate"),t.k0s(),t.nrm(16,"ion-icon",8),t.k0s()()(),t.bVm()}if(2&g){const s=t.XpG();let e,c;t.R7$(7),t.JRh(null!==(e=s.chargingLocation.OpenTimeStart)&&void 0!==e?e:"--:--"),t.R7$(3),t.JRh(null!==(c=s.chargingLocation.OpenTimeEnd)&&void 0!==c?c:"--:--"),t.R7$(2),t.Y8G("color",s.APP_FUNC_GetColor_VLocationStatus(s.chargingLocation.VLocationStatus)),t.R7$(2),t.JRh(t.bMT(15,4,"Direction"))}}function p(g,M){if(1&g){const s=t.RV6();t.j41(0,"div",9)(1,"div",10),t.bIt("click",function(){const a=t.eBV(s).$implicit,m=t.XpG();return t.Njj(m.openDetail(a.ChargeLocationId))}),t.j41(2,"div",11)(3,"ion-thumbnail"),t.nrm(4,"img",12),t.k0s(),t.j41(5,"div",13)(6,"small"),t.EFF(7),t.k0s()()(),t.j41(8,"div",14)(9,"h6",15)(10,"b"),t.EFF(11),t.k0s()(),t.j41(12,"div"),t.nrm(13,"ion-icon",16),t.j41(14,"ion-text",6)(15,"small",17)(16,"b"),t.EFF(17),t.k0s(),t.EFF(18),t.k0s()()(),t.j41(19,"div")(20,"small"),t.EFF(21),t.k0s()()()()()}if(2&g){const s=M.$implicit,e=t.XpG();let c,a;t.R7$(4),t.Y8G("src",e.getLocImage(s),t.B4B),t.R7$(3),t.SpI("",e.getDistance2CL(s),"km"),t.R7$(4),t.JRh(s.LocName),t.R7$(5),t.HbH(s.TotalConnectorReady?"text-primary":"text-danger"),t.R7$(1),t.JRh(null!==(c=s.TotalConnectorReady)&&void 0!==c?c:0),t.R7$(1),t.SpI("/",null!==(a=s.TotalConnector)&&void 0!==a?a:0," \u0111\u1ea7u s\u1ea1c s\u1eb5n s\xe0ng"),t.R7$(3),t.JRh(s.LocAddress)}}let x=(()=>{var g;class M{constructor(e,c){this.modalController=e,this.toastController=c,this.APP_ROUTE=y._,this.APP_FUNC_GetColor_VLocationStatus=u.Bb,this.currentPosition=O.c.app_default.geolocation.pos,(0,f.X)().then(a=>this.currentPosition=a)}ngOnInit(){this.loadData()}loadData(){var e=this;return(0,L.A)(function*(){(0,I.x1)({params:{ChargeLocationId:e.ChargeLocationId},callback:c=>{var a,m,h,o,n;null!=c&&c.Succeeded?(e.chargingLocation=null!==(a=c.Data)&&void 0!==a?a:{},null!==(m=e.chargingLocation)&&void 0!==m&&m.LocImages&&"string"==typeof(null===(h=e.chargingLocation)||void 0===h?void 0:h.LocImages)&&(e.chargingLocation.LocImage=(null!==(o=JSON.parse(null===(n=e.chargingLocation)||void 0===n?void 0:n.LocImages))&&void 0!==o?o:[])[0].imageurl)):(0,A.cX)(e.toastController,{},c).then(r=>r.present())}})})()}openDetail(e){return(0,L.A)(function*(){window.location.href=y._.CHARGING_LOCATION_DETAIL.replace(":id",e)})()}Direction(){var e=this;return(0,L.A)(function*(){e.modalController.dismiss(e.chargingLocation,"Direction")})()}OpenGoogleMap(){var e=this;return(0,L.A)(function*(){e.modalController.dismiss(e.chargingLocation,"GoogleMap")})()}openDirection(e,c){var a=this;return(0,L.A)(function*(){a.modalController.dismiss(c,"GoogleMap")})()}getDistance2CL(e){return parseFloat((0,u.GH)(this.currentPosition,{lat:null==e?void 0:e.LocLat,lng:null==e?void 0:e.LocLong}).toFixed(2))}getLocImage(e){var c;if(!e.LocImage&&e.LocImages)if("string"==typeof e.LocImages){var a,m;e.LocImage=(null!==(a=(null!==(m=JSON.parse(e.LocImages))&&void 0!==m?m:[])[0])&&void 0!==a?a:{}).imageurl}else{var h,o;e.LocImage=(null!==(h=(null!==(o=e.LocImages)&&void 0!==o?o:[])[0])&&void 0!==h?h:{}).imageurl}return null!==(c=e.LocImage)&&void 0!==c?c:"assets/favicon/favicon.svg"}}return(g=M).\u0275fac=function(e){return new(e||g)(t.rXU(d.W3),t.rXU(d.K_))},g.\u0275cmp=t.VBU({type:g,selectors:[["app-modal-map-market"]],inputs:{ChargeLocationId:"ChargeLocationId"},decls:6,vars:2,consts:[[4,"ngIf"],["templateChargingLocation",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"px-3"],[1,"m-0"],[1,"d-flex","align-items-center","justify-content-between","px-3","py-2"],["color","medium"],["shape","round",3,"color","click"],["src","../../../assets/icon/ion-icon/direction.svg","color","primary","slot","end"],[1,"card-day"],[1,"d-flex","align-items-start","px-3","pt-3","cursor-pointer",3,"click"],[1,"col-auto","px-0"],[3,"src"],[1,"text-danger","text-center","mt-1"],[1,"col","pr-0"],[1,"my-0"],["src","../../../assets/icon/ion-icon/electric.svg","color","primary"],[1,"font-weight-medium"]],template:function(e,c){1&e&&(t.j41(0,"ion-content"),t.DNE(1,T,2,4,"ng-container",0),t.k0s(),t.j41(2,"ion-footer"),t.DNE(3,k,17,6,"ng-container",0),t.k0s(),t.DNE(4,p,22,8,"ng-template",null,1,t.C5r)),2&e&&(t.R7$(1),t.Y8G("ngIf",c.chargingLocation),t.R7$(2),t.Y8G("ngIf",c.chargingLocation))},dependencies:[P.bT,P.T3,d.Jm,d.W9,d.M0,d.iq,d.he,d.IO,d.Zx,D.D9],styles:["ion-footer[_ngcontent-%COMP%]{box-shadow:none}.card-day[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{width:3rem;height:3rem;--border-radius: .5rem}.card-day[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .card-day[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{vertical-align:middle}.card-day[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{margin:0 1rem 1rem}.market-info[_ngcontent-%COMP%]{cursor:pointer}.market-info[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;font-size:.75rem}.market-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;margin-left:.5rem;vertical-align:middle;font-size:.75rem}"]}),M})()},3311:(W,b,i)=>{i.r(b),i.d(b,{MapVietbandoPageModule:()=>c});var L=i(177),O=i(9417),f=i(4488),I=i(2175),u=i(467),A=i(9976),y=i(7392),t=i(7762),d=i(5312),P=i(3801),D=i(6841),R=i(1312),T=i(7518),k=i(8833),p=i(4438),x=i(345);const M=[{path:"",component:(()=>{var a;class m{constructor(o,n,r,l){this.modalController=n,this.animationController=r,this.toastController=l,this.APP_ROUTE=k._,this.markers=[],this.ChargingLocationParams={TopLeftLat:10.914656,TopLeftLong:106.44876,RightBottomLat:10.305755,RightBottomLong:107.1056,PageNumber:1,PageSize:100},this.ChargingLocations=[],this.timeoutLoadData=-1,this.isWaitLoad=!1,o.setTitle("T\xecm tr\u1ea1m s\u1ea1c")}ngOnInit(){this.refreshCurrentPosition()}ngAfterViewInit(){if(this.vbd)this.createMap();else{let o=document.createElement("script");o.src="https://developers.vietbando.com/V2/Scripts/VietbandoMapsAPI.js?key=eded04b3-6981-489d-b617-a5e5d9f609dd",o.onload=()=>{this.createMap()},window.document.head.append(o)}}get vbd(){return window.vbd}onSearchbarChange(o){var n=this;return(0,u.A)(function*(){console.log("onSearchbarChange",o);let r=o.detail.value;r&&(0,D.tC)({params:{Search:r,PageNumber:1,PageSize:10},callback:l=>{var v;n.response=l,null!=l&&l.Succeeded&&l.Data&&(l.Data.forEach(C=>{var _,E;n.markers.push({id:C.ChargeLocationId,title:C.LocAddress,position:{lat:null!==(_=C.LocLat)&&void 0!==_?_:d.c.app_default.geolocation.pos.lat,lng:null!==(E=C.LocLong)&&void 0!==E?E:d.c.app_default.geolocation.pos.lng}})}),n.createMarker(),n.ChargingLocations=null!==(v=l.Data)&&void 0!==v?v:[])}})})()}onSearchbarCancel(o){return(0,u.A)(function*(){console.log("onSearchbarCancel",o)})()}onSearchbarClear(o){var n=this;return(0,u.A)(function*(){console.log("onSearchbarClear",o),n.ChargingLocations.length=0})()}loadData(){var o=this;return(0,u.A)(function*(){(0,D.Bc)({params:o.ChargingLocationParams,callback:n=>{o.response=n,null!=n&&n.Succeeded&&n.Data&&(n.Data.forEach(r=>{var l,v;o.markers.push({id:r.ChargeLocationId,title:r.LocAddress,position:{lat:null!==(l=r.LocLat)&&void 0!==l?l:d.c.app_default.geolocation.pos.lat,lng:null!==(v=r.LocLong)&&void 0!==v?v:d.c.app_default.geolocation.pos.lng}})}),o.createMarker())}})})()}waitLoad(){var o=this;return(0,u.A)(function*(){if(o.timeoutLoadData=1e3,o.isWaitLoad)return;o.isWaitLoad=!0;let n=setInterval(()=>{o.timeoutLoadData>=0?o.timeoutLoadData-=100:(clearTimeout(n),o.isWaitLoad=!1,o.loadData())},100)})()}refreshCurrentPosition(o){var n=this;return(0,u.A)(function*(){let r=yield(0,P.X)();t.L.getCurrentPosition({enableHighAccuracy:!0,maximumAge:3e5}).then(l=>{l.coords&&(r={lat:l.coords.latitude,lng:l.coords.longitude},(0,P.f)({params:r}),n.createCurrentPosition(r),n.resetCamera(r))}),n.createCurrentPosition(r),n.resetCamera(r)})()}currentGeolocation(o){var n=this;return(0,u.A)(function*(){return r=null!=o?o:yield(0,P.X)(),new n.vbd.LatLng(r.lat,r.lng);var r})()}createMap(){var o=this;return(0,u.A)(function*(){o.map=new o.vbd.Map(document.getElementById("map"),{center:yield o.currentGeolocation(),zoom:d.c.app_default.geolocation.zoom,maxZoom:18,minZoom:6,layer:null,zoomControl:!1,scaleControl:!1}),window.map=o.map,o.vbd.event.addListener(o.map,"boundchange",()=>{let n=o.map.getBounds();if(n&&"object"==typeof n){let r=[],l=[];r.push(n.sw.Latitude),r.push(n.sw.Longitude),l.push(n.ne.Latitude),l.push(n.ne.Longitude),o.ChargingLocationParams.TopLeftLat=Math.min.apply(null,l),o.ChargingLocationParams.TopLeftLong=Math.max.apply(null,r),o.ChargingLocationParams.RightBottomLat=Math.min.apply(null,r),o.ChargingLocationParams.RightBottomLong=Math.max.apply(null,l)}o.waitLoad()}),o.refreshCurrentPosition()})()}resetCamera(o){var n=this;return(0,u.A)(function*(){n.map&&(n.map.setCenter(yield n.currentGeolocation()),n.map.setZoom(d.c.app_default.geolocation.zoom))})()}createCurrentPosition(o){var n=this;return(0,u.A)(function*(){n.markerGeoLocaltion&&n.markerGeoLocaltion.setMap(null),n.markerGeoLocaltion=new n.vbd.Marker({map:n.map,position:yield n.currentGeolocation(o),icon:{url:d.c.app_default.icon.currentlocaltion,size:new n.vbd.Size(40,40)}})})()}createMarker(){var o=this;return(0,u.A)(function*(){o.markers.forEach(n=>{let r=new o.vbd.Marker({map:o.map,position:(l=n.position,new o.vbd.LatLng(l.lat,l.lng)),title:n.title,icon:{url:d.c.app_default.icon.marker,size:new o.vbd.Size(30,40)}});var l;o.vbd.event.addListener(r,"click",()=>{o.presentModalMarket(void 0,n.id)})})})()}openDirectionByGoogleMap(o){return(0,u.A)(function*(){yield y.P.open({url:(0,R.LZ)(yield(0,P.X)(),o.position)})})()}presentModalMarket(o,n){var r=this;return(0,u.A)(function*(){const l=yield r.modalController.create({component:A.Z,componentProps:{ChargeLocationId:n},mode:"ios",cssClass:"ion-modal-map-market"});l.onDidDismiss().then(v=>{var C,_,E,G,V,B,F,j,U,S;"Direction"!=v.role&&"GoogleMap"==v.role&&r.openDirectionByGoogleMap({id:null!==(C=null===(_=v.data)||void 0===_?void 0:_.ChargeLocationId)&&void 0!==C?C:0,title:null!==(E=null!==(G=null===(V=v.data)||void 0===V?void 0:V.LocName)&&void 0!==G?G:null===(B=v.data)||void 0===B?void 0:B.LocAddress)&&void 0!==E?E:"",position:{lat:null!==(F=null===(j=v.data)||void 0===j?void 0:j.LocLat)&&void 0!==F?F:d.c.app_default.geolocation.pos.lat,lng:null!==(U=null===(S=v.data)||void 0===S?void 0:S.LocLong)&&void 0!==U?U:d.c.app_default.geolocation.pos.lng}})}),l.present()})()}presentModalNotify(o){var n=this;return(0,u.A)(function*(){(0,T.He)(n.modalController,n.animationController)})()}}return(a=m).\u0275fac=function(o){return new(o||a)(p.rXU(x.hE),p.rXU(f.W3),p.rXU(f.Hx),p.rXU(f.K_))},a.\u0275cmp=p.VBU({type:a,selectors:[["app-map-vietbando"]],decls:5,vars:1,consts:[["scroll-x","false","scroll-y","false",3,"fullscreen"],["id","map"],[1,"position-absolute","bottom-0","right-0"],["id","btn-geolocation","color","light",3,"click"],["src","../../../assets/icon/map/geolocation.svg"]],template:function(o,n){1&o&&(p.j41(0,"ion-content",0),p.nrm(1,"div",1),p.j41(2,"div",2)(3,"ion-button",3),p.bIt("click",function(l){return n.refreshCurrentPosition(l)}),p.nrm(4,"ion-icon",4),p.k0s()()()),2&o&&p.Y8G("fullscreen",!0)},dependencies:[f.Jm,f.W9,f.iq],styles:["#map[_ngcontent-%COMP%]{width:100%;height:100%;width:100vw;height:100vh}#btn-geolocation[_ngcontent-%COMP%]{width:3rem;height:3rem;min-width:3rem;min-height:3rem;--padding-top: 0;--padding-start: 0;--padding-end: 0;--padding-bottom: 0;--border-radius: 50%;margin:0 1rem 6rem 0}#btn-geolocation[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:3rem;color:var(--ion-color-tertiary)}"]}),m})()}];let s=(()=>{var a;class m{}return(a=m).\u0275fac=function(o){return new(o||a)},a.\u0275mod=p.$C({type:a}),a.\u0275inj=p.G2t({imports:[I.iI.forChild(M),I.iI]}),m})();var e=i(9500);let c=(()=>{var a;class m{}return(a=m).\u0275fac=function(o){return new(o||a)},a.\u0275mod=p.$C({type:a}),a.\u0275inj=p.G2t({imports:[L.MD,O.YN,f.bv,s,e.x]}),m})()}}]);