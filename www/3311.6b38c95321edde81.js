"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3311],{9976:(W,b,r)=>{r.d(b,{Z:()=>x});var L=r(467),O=r(5312),f=r(3801),I=r(6841),m=r(1312),A=r(7518),y=r(8833),o=r(4438),s=r(8974),P=r(177),D=r(4842);const R=u=>({$implicit:u});function T(u,M){if(1&u&&(o.qex(0),o.eu8(1,2),o.bVm()),2&u){const p=o.XpG(),e=o.sdS(5);o.R7$(),o.Y8G("ngTemplateOutlet",e)("ngTemplateOutletContext",o.eq3(2,R,p.chargingLocation))}}function k(u,M){if(1&u){const p=o.RV6();o.qex(0),o.j41(1,"div",3),o.nrm(2,"hr",4),o.k0s(),o.j41(3,"div",5)(4,"div")(5,"ion-text",6)(6,"small"),o.EFF(7),o.k0s(),o.EFF(8," - "),o.j41(9,"small"),o.EFF(10),o.k0s()()(),o.j41(11,"div")(12,"ion-button",7),o.bIt("click",function(i){o.eBV(p);const a=o.XpG();return o.Njj(a.openDirection(i,a.chargingLocation))}),o.j41(13,"ion-label"),o.EFF(14),o.nI1(15,"translate"),o.k0s(),o.nrm(16,"ion-icon",8),o.k0s()()(),o.bVm()}if(2&u){let p,e;const i=o.XpG();o.R7$(7),o.JRh(null!==(p=i.chargingLocation.OpenTimeStart)&&void 0!==p?p:"--:--"),o.R7$(3),o.JRh(null!==(e=i.chargingLocation.OpenTimeEnd)&&void 0!==e?e:"--:--"),o.R7$(2),o.Y8G("color",i.APP_FUNC_GetColor_VLocationStatus(i.chargingLocation.VLocationStatus)),o.R7$(2),o.JRh(o.bMT(15,4,"Direction"))}}function d(u,M){if(1&u){const p=o.RV6();o.j41(0,"div",9)(1,"div",10),o.bIt("click",function(){const i=o.eBV(p).$implicit,a=o.XpG();return o.Njj(a.openDetail(i.ChargeLocationId))}),o.j41(2,"div",11)(3,"ion-thumbnail"),o.nrm(4,"img",12),o.k0s(),o.j41(5,"div",13)(6,"small"),o.EFF(7),o.k0s()()(),o.j41(8,"div",14)(9,"h6",15)(10,"b"),o.EFF(11),o.k0s()(),o.j41(12,"div"),o.nrm(13,"ion-icon",16),o.j41(14,"ion-text",6)(15,"small",17)(16,"b"),o.EFF(17),o.k0s(),o.EFF(18),o.k0s()()(),o.j41(19,"div")(20,"small"),o.EFF(21),o.k0s()()()()()}if(2&u){let p,e;const i=M.$implicit,a=o.XpG();o.R7$(4),o.Y8G("src",a.getLocImage(i),o.B4B),o.R7$(3),o.SpI("",a.getDistance2CL(i),"km"),o.R7$(4),o.JRh(i.LocName),o.R7$(5),o.HbH(i.TotalConnectorReady?"text-primary":"text-danger"),o.R7$(),o.JRh(null!==(p=i.TotalConnectorReady)&&void 0!==p?p:0),o.R7$(),o.SpI("/",null!==(e=i.TotalConnector)&&void 0!==e?e:0," \u0111\u1ea7u s\u1ea1c s\u1eb5n s\xe0ng"),o.R7$(3),o.JRh(i.LocAddress)}}let x=(()=>{var u;class M{constructor(e,i){this.modalController=e,this.toastController=i,this.APP_ROUTE=y._,this.APP_FUNC_GetColor_VLocationStatus=m.Bb,this.currentPosition=O.c.app_default.geolocation.pos,(0,f.X)().then(a=>this.currentPosition=a)}ngOnInit(){this.loadData()}loadData(){var e=this;return(0,L.A)(function*(){(0,I.x1)({params:{ChargeLocationId:e.ChargeLocationId},callback:i=>{var a,g,h,t,n;null!=i&&i.Succeeded?(e.chargingLocation=null!==(a=i.Data)&&void 0!==a?a:{},null!==(g=e.chargingLocation)&&void 0!==g&&g.LocImages&&"string"==typeof(null===(h=e.chargingLocation)||void 0===h?void 0:h.LocImages)&&(e.chargingLocation.LocImage=(null!==(t=JSON.parse(null===(n=e.chargingLocation)||void 0===n?void 0:n.LocImages))&&void 0!==t?t:[])[0].imageurl)):(0,A.cX)(e.toastController,{},i).then(l=>l.present())}})})()}openDetail(e){return(0,L.A)(function*(){window.location.href=y._.CHARGING_LOCATION_DETAIL.replace(":id",e)})()}Direction(){var e=this;return(0,L.A)(function*(){e.modalController.dismiss(e.chargingLocation,"Direction")})()}OpenGoogleMap(){var e=this;return(0,L.A)(function*(){e.modalController.dismiss(e.chargingLocation,"GoogleMap")})()}openDirection(e,i){var a=this;return(0,L.A)(function*(){a.modalController.dismiss(i,"GoogleMap")})()}getDistance2CL(e){return parseFloat((0,m.GH)(this.currentPosition,{lat:null==e?void 0:e.LocLat,lng:null==e?void 0:e.LocLong}).toFixed(2))}getLocImage(e){var i;if(!e.LocImage&&e.LocImages)if("string"==typeof e.LocImages){var a,g;e.LocImage=(null!==(a=(null!==(g=JSON.parse(e.LocImages))&&void 0!==g?g:[])[0])&&void 0!==a?a:{}).imageurl}else{var h,t;e.LocImage=(null!==(h=(null!==(t=e.LocImages)&&void 0!==t?t:[])[0])&&void 0!==h?h:{}).imageurl}return null!==(i=e.LocImage)&&void 0!==i?i:"assets/favicon/favicon.svg"}}return(u=M).\u0275fac=function(e){return new(e||u)(o.rXU(s.W3),o.rXU(s.K_))},u.\u0275cmp=o.VBU({type:u,selectors:[["app-modal-map-market"]],inputs:{ChargeLocationId:"ChargeLocationId"},decls:6,vars:2,consts:[["templateChargingLocation",""],[4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"px-3"],[1,"m-0"],[1,"d-flex","align-items-center","justify-content-between","px-3","py-2"],["color","medium"],["shape","round",3,"click","color"],["src","../../../assets/icon/ion-icon/direction.svg","color","primary","slot","end"],[1,"card-day"],[1,"d-flex","align-items-start","px-3","pt-3","cursor-pointer",3,"click"],[1,"col-auto","px-0"],[3,"src"],[1,"text-danger","text-center","mt-1"],[1,"col","pr-0"],[1,"my-0"],["src","../../../assets/icon/ion-icon/electric.svg","color","primary"],[1,"font-weight-medium"]],template:function(e,i){1&e&&(o.j41(0,"ion-content"),o.DNE(1,T,2,4,"ng-container",1),o.k0s(),o.j41(2,"ion-footer"),o.DNE(3,k,17,6,"ng-container",1),o.k0s(),o.DNE(4,d,22,8,"ng-template",null,0,o.C5r)),2&e&&(o.R7$(),o.Y8G("ngIf",i.chargingLocation),o.R7$(2),o.Y8G("ngIf",i.chargingLocation))},dependencies:[P.bT,P.T3,s.Jm,s.W9,s.M0,s.iq,s.he,s.IO,s.Zx,D.D9],styles:["ion-footer[_ngcontent-%COMP%]{box-shadow:none}.card-day[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{width:3rem;height:3rem;--border-radius: .5rem}.card-day[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .card-day[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{vertical-align:middle}.card-day[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{margin:0 1rem 1rem}.market-info[_ngcontent-%COMP%]{cursor:pointer}.market-info[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;font-size:.75rem}.market-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;margin-left:.5rem;vertical-align:middle;font-size:.75rem}"]}),M})()},3311:(W,b,r)=>{r.r(b),r.d(b,{MapVietbandoPageModule:()=>i});var L=r(177),O=r(9417),f=r(8974),I=r(2175),m=r(467),A=r(9976),y=r(7392),o=r(7762),s=r(5312),P=r(3801),D=r(6841),R=r(1312),T=r(7518),k=r(8833),d=r(4438),x=r(345);const M=[{path:"",component:(()=>{var a;class g{constructor(t,n,l,c){this.modalController=n,this.animationController=l,this.toastController=c,this.APP_ROUTE=k._,this.markers=[],this.ChargingLocationParams={TopLeftLat:10.914656,TopLeftLong:106.44876,RightBottomLat:10.305755,RightBottomLong:107.1056,PageNumber:1,PageSize:100},this.ChargingLocations=[],this.timeoutLoadData=-1,this.isWaitLoad=!1,t.setTitle("T\xecm tr\u1ea1m s\u1ea1c")}ngOnInit(){this.refreshCurrentPosition()}ngAfterViewInit(){if(this.vbd)this.createMap();else{let t=document.createElement("script");t.src="https://developers.vietbando.com/V2/Scripts/VietbandoMapsAPI.js?key=eded04b3-6981-489d-b617-a5e5d9f609dd",t.onload=()=>{this.createMap()},window.document.head.append(t)}}get vbd(){return window.vbd}onSearchbarChange(t){var n=this;return(0,m.A)(function*(){console.log("onSearchbarChange",t);let l=t.detail.value;l&&(0,D.tC)({params:{Search:l,PageNumber:1,PageSize:10},callback:c=>{var v;n.response=c,null!=c&&c.Succeeded&&c.Data&&(c.Data.forEach(C=>{var _,E;n.markers.push({id:C.ChargeLocationId,title:C.LocAddress,position:{lat:null!==(_=C.LocLat)&&void 0!==_?_:s.c.app_default.geolocation.pos.lat,lng:null!==(E=C.LocLong)&&void 0!==E?E:s.c.app_default.geolocation.pos.lng}})}),n.createMarker(),n.ChargingLocations=null!==(v=c.Data)&&void 0!==v?v:[])}})})()}onSearchbarCancel(t){return(0,m.A)(function*(){console.log("onSearchbarCancel",t)})()}onSearchbarClear(t){var n=this;return(0,m.A)(function*(){console.log("onSearchbarClear",t),n.ChargingLocations.length=0})()}loadData(){var t=this;return(0,m.A)(function*(){(0,D.Bc)({params:t.ChargingLocationParams,callback:n=>{t.response=n,null!=n&&n.Succeeded&&n.Data&&(n.Data.forEach(l=>{var c,v;t.markers.push({id:l.ChargeLocationId,title:l.LocAddress,position:{lat:null!==(c=l.LocLat)&&void 0!==c?c:s.c.app_default.geolocation.pos.lat,lng:null!==(v=l.LocLong)&&void 0!==v?v:s.c.app_default.geolocation.pos.lng}})}),t.createMarker())}})})()}waitLoad(){var t=this;return(0,m.A)(function*(){if(t.timeoutLoadData=1e3,t.isWaitLoad)return;t.isWaitLoad=!0;let n=setInterval(()=>{t.timeoutLoadData>=0?t.timeoutLoadData-=100:(clearTimeout(n),t.isWaitLoad=!1,t.loadData())},100)})()}refreshCurrentPosition(t){var n=this;return(0,m.A)(function*(){let l=yield(0,P.X)();o.L.getCurrentPosition({enableHighAccuracy:!0,maximumAge:3e5}).then(c=>{c.coords&&(l={lat:c.coords.latitude,lng:c.coords.longitude},(0,P.f)({params:l}),n.createCurrentPosition(l),n.resetCamera(l))}),n.createCurrentPosition(l),n.resetCamera(l)})()}currentGeolocation(t){var n=this;return(0,m.A)(function*(){return l=null!=t?t:yield(0,P.X)(),new n.vbd.LatLng(l.lat,l.lng);var l})()}createMap(){var t=this;return(0,m.A)(function*(){t.map=new t.vbd.Map(document.getElementById("map"),{center:yield t.currentGeolocation(),zoom:s.c.app_default.geolocation.zoom,maxZoom:18,minZoom:6,layer:null,zoomControl:!1,scaleControl:!1}),window.map=t.map,t.vbd.event.addListener(t.map,"boundchange",()=>{let n=t.map.getBounds();if(n&&"object"==typeof n){let l=[],c=[];l.push(n.sw.Latitude),l.push(n.sw.Longitude),c.push(n.ne.Latitude),c.push(n.ne.Longitude),t.ChargingLocationParams.TopLeftLat=Math.min.apply(null,c),t.ChargingLocationParams.TopLeftLong=Math.max.apply(null,l),t.ChargingLocationParams.RightBottomLat=Math.min.apply(null,l),t.ChargingLocationParams.RightBottomLong=Math.max.apply(null,c)}t.waitLoad()}),t.refreshCurrentPosition()})()}resetCamera(t){var n=this;return(0,m.A)(function*(){n.map&&(n.map.setCenter(yield n.currentGeolocation()),n.map.setZoom(s.c.app_default.geolocation.zoom))})()}createCurrentPosition(t){var n=this;return(0,m.A)(function*(){n.markerGeoLocaltion&&n.markerGeoLocaltion.setMap(null),n.markerGeoLocaltion=new n.vbd.Marker({map:n.map,position:yield n.currentGeolocation(t),icon:{url:s.c.app_default.icon.currentlocaltion,size:new n.vbd.Size(40,40)}})})()}createMarker(){var t=this;return(0,m.A)(function*(){t.markers.forEach(n=>{let l=new t.vbd.Marker({map:t.map,position:(c=n.position,new t.vbd.LatLng(c.lat,c.lng)),title:n.title,icon:{url:s.c.app_default.icon.marker,size:new t.vbd.Size(30,40)}});var c;t.vbd.event.addListener(l,"click",()=>{t.presentModalMarket(void 0,n.id)})})})()}openDirectionByGoogleMap(t){return(0,m.A)(function*(){yield y.P.open({url:(0,R.LZ)(yield(0,P.X)(),t.position)})})()}presentModalMarket(t,n){var l=this;return(0,m.A)(function*(){const c=yield l.modalController.create({component:A.Z,componentProps:{ChargeLocationId:n},mode:"ios",cssClass:"ion-modal-map-market"});c.onDidDismiss().then(v=>{var C,_,E,G,V,B,F,j,U,S;"Direction"!=v.role&&"GoogleMap"==v.role&&l.openDirectionByGoogleMap({id:null!==(C=null===(_=v.data)||void 0===_?void 0:_.ChargeLocationId)&&void 0!==C?C:0,title:null!==(E=null!==(G=null===(V=v.data)||void 0===V?void 0:V.LocName)&&void 0!==G?G:null===(B=v.data)||void 0===B?void 0:B.LocAddress)&&void 0!==E?E:"",position:{lat:null!==(F=null===(j=v.data)||void 0===j?void 0:j.LocLat)&&void 0!==F?F:s.c.app_default.geolocation.pos.lat,lng:null!==(U=null===(S=v.data)||void 0===S?void 0:S.LocLong)&&void 0!==U?U:s.c.app_default.geolocation.pos.lng}})}),c.present()})()}presentModalNotify(t){var n=this;return(0,m.A)(function*(){(0,T.He)(n.modalController,n.animationController)})()}}return(a=g).\u0275fac=function(t){return new(t||a)(d.rXU(x.hE),d.rXU(f.W3),d.rXU(f.Hx),d.rXU(f.K_))},a.\u0275cmp=d.VBU({type:a,selectors:[["app-map-vietbando"]],decls:5,vars:1,consts:[["scroll-x","false","scroll-y","false",3,"fullscreen"],["id","map"],[1,"position-absolute","bottom-0","right-0"],["id","btn-geolocation","color","light",3,"click"],["src","../../../assets/icon/map/geolocation.svg"]],template:function(t,n){1&t&&(d.j41(0,"ion-content",0),d.nrm(1,"div",1),d.j41(2,"div",2)(3,"ion-button",3),d.bIt("click",function(c){return n.refreshCurrentPosition(c)}),d.nrm(4,"ion-icon",4),d.k0s()()()),2&t&&d.Y8G("fullscreen",!0)},dependencies:[f.Jm,f.W9,f.iq],styles:["#map[_ngcontent-%COMP%]{width:100%;height:100%;width:100vw;height:100vh}#btn-geolocation[_ngcontent-%COMP%]{width:3rem;height:3rem;min-width:3rem;min-height:3rem;--padding-top: 0;--padding-start: 0;--padding-end: 0;--padding-bottom: 0;--border-radius: 50%;margin:0 1rem 6rem 0}#btn-geolocation[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:3rem;color:var(--ion-color-tertiary)}"]}),g})()}];let p=(()=>{var a;class g{}return(a=g).\u0275fac=function(t){return new(t||a)},a.\u0275mod=d.$C({type:a}),a.\u0275inj=d.G2t({imports:[I.iI.forChild(M),I.iI]}),g})();var e=r(9500);let i=(()=>{var a;class g{}return(a=g).\u0275fac=function(t){return new(t||a)},a.\u0275mod=d.$C({type:a}),a.\u0275inj=d.G2t({imports:[L.MD,O.YN,f.bv,p,e.x]}),g})()}}]);